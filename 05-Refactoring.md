Actua como un ingeniero de rendimiento y clean code especializado en [tu lenguaje/framework]. Necesito que refactorices el siguiente código. Funciona, pero necesita mejorar.

## Código actual
```
[Pega aquí el código que funciona pero quieres mejorar]
```

## Qué hace este código
[Explica brevemente la funcionalidad]

## Qué me preocupa
[Elige uno o varios: "Es lento" / "Es difícil de leer" / "Es difícil de extender" / "No estoy seguro de que escale" / "Hay mucha duplicación"]

## Reglas de refactor
1.No cambiar el comportamiento externo. La entrada y salida deben seguir siendo exactamente las mismas.
2.Explicar cada cambio. No quiero código nuevo sin entender que  cambiaste y por qué.
3.Mostrar el antes y después de cada bloque modificado.

## Entrega
- Código refactorizado completo.
- Tabla de cambios con 3 columnas: Qué cambié | Por qué | Impacto esperado.
- Si hay mejora de rendimiento, estima la complejidad antes (Ej: O(n^2)) y después (Ej: O(n log n)).
- Si algún cambio introduce una dependencia nueva o un patrón diferente, justifícalo.
